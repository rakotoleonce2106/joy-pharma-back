{% if form %}
    {{ form_start(form, { attr: {
        'id': 'store-settings-form',
        'class': 'space-y-6'
    } }) }}

    <div class="space-y-4">
        {% set days = [
            { key: 'mondayHours', label: 'Monday', value: store.setting ? store.setting.mondayHours : null },
            { key: 'tuesdayHours', label: 'Tuesday', value: store.setting ? store.setting.tuesdayHours : null },
            { key: 'wednesdayHours', label: 'Wednesday', value: store.setting ? store.setting.wednesdayHours : null },
            { key: 'thursdayHours', label: 'Thursday', value: store.setting ? store.setting.thursdayHours : null },
            { key: 'fridayHours', label: 'Friday', value: store.setting ? store.setting.fridayHours : null },
            { key: 'saturdayHours', label: 'Saturday', value: store.setting ? store.setting.saturdayHours : null },
            { key: 'sundayHours', label: 'Sunday', value: store.setting ? store.setting.sundayHours : null },
        ] %}

        {% for day in days %}
            {% if form[day.key] is defined %}
                {% set dayForm = form[day.key] %}
                <div class="p-4 border rounded-lg space-y-3" data-day="{{ day.key }}">
                    <div class="flex items-center justify-between">
                        <h4 class="text-sm font-medium">{{ day.label }}</h4>
                        <div class="flex items-center space-x-2">
                            {% if dayForm.children.isClosed is defined %}
                                {% set isClosedField = dayForm.children.isClosed %}
                                {{ form_widget(isClosedField, { attr: {
                                    'class': 'rounded border-gray-300',
                                    'data-day': day.key
                                } }) }}
                                <label for="{{ isClosedField.vars.id }}" class="text-sm text-gray-600">Closed</label>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 closed-dependent" data-day="{{ day.key }}">
                        {% if dayForm.children.openTime is defined %}
                            {% set openTimeField = dayForm.children.openTime %}
                            <div>
                                <label for="{{ openTimeField.vars.id }}" class="block text-sm font-medium mb-1">Open Time</label>
                                {{ form_widget(openTimeField, { attr: {
                                    'class': 'w-full rounded-md border border-input bg-background px-3 py-2 text-sm',
                                    'data-day': day.key,
                                    'type': 'time'
                                } }) }}
                                {{ form_errors(openTimeField) }}
                            </div>
                        {% endif %}
                        {% if dayForm.children.closeTime is defined %}
                            {% set closeTimeField = dayForm.children.closeTime %}
                            <div>
                                <label for="{{ closeTimeField.vars.id }}" class="block text-sm font-medium mb-1">Close Time</label>
                                {{ form_widget(closeTimeField, { attr: {
                                    'class': 'w-full rounded-md border border-input bg-background px-3 py-2 text-sm',
                                    'data-day': day.key,
                                    'type': 'time'
                                } }) }}
                                {{ form_errors(closeTimeField) }}
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <div class="flex items-center justify-end gap-2 pt-4 border-t">
        <twig:ui:button:root type="submit" form="store-settings-form" size="sm" data-turbo-submits-with="Updating...">
            <twig:ux:icon name="lucide:save" class="h-4 w-4 mr-2"/>
            {{ 'Update Settings'|trans }}
        </twig:ui:button:root>
    </div>

    {{ form_end(form) }}

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Handle closed checkbox toggling
            document.querySelectorAll('[data-day] input[type="checkbox"]').forEach(function(checkbox) {
                const dayKey = checkbox.dataset.day;
                const timeContainer = document.querySelector(`[data-day="${dayKey}"].closed-dependent`);
                
                function updateTimeFields() {
                    if (checkbox.checked) {
                        timeContainer.style.opacity = '0.5';
                        timeContainer.style.pointerEvents = 'none';
                        const inputs = timeContainer.querySelectorAll('input[type="time"]');
                        inputs.forEach(input => {
                            input.value = '';
                            input.disabled = true;
                        });
                    } else {
                        timeContainer.style.opacity = '1';
                        timeContainer.style.pointerEvents = 'auto';
                        const inputs = timeContainer.querySelectorAll('input[type="time"]');
                        inputs.forEach(input => {
                            input.disabled = false;
                        });
                    }
                }
                
                checkbox.addEventListener('change', updateTimeFields);
                updateTimeFields(); // Initialize on page load
            });
        });
    </script>
{% else %}
    <div class="flex flex-col items-center justify-center py-12 text-center">
        <div class="rounded-full bg-muted p-4 mb-4">
            <twig:ux:icon name="lucide:settings" class="h-12 w-12 text-muted-foreground"/>
        </div>
        <h3 class="text-lg font-semibold mb-2">{{ 'No Settings Found'|trans }}</h3>
        <p class="text-sm text-muted-foreground">
            {{ 'Store settings are not available for this store.'|trans }}
        </p>
    </div>
{% endif %}
