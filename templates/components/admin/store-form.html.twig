<div {{ attributes }}>
    {{ form_start(form, { attr: {
        class: 'space-y-6',
        'id': 'store-form'
    } }) }}

    {# Store Information Section #}
    <div class="space-y-4">
        <div class="flex items-center gap-2 pb-2 border-b">
            <twig:ux:icon name="lucide:store" class="h-5 w-5 text-primary"/>
            <h3 class="text-lg font-semibold">Store Information</h3>
        </div>
        <div class="grid gap-4">
            <div>
                {{ form_row(form.name, {
                    'help': 'Enter the pharmacy/store name'
                }) }}
            </div>
            <div>
                {{ form_row(form.categories, {
                    'help': 'Select store categories (pharmacy, health, etc.)'
                }) }}
            </div>
            <div>
                {{ form_row(form.description, {
                    'help': 'Brief description of your store, services, and specialties'
                }) }}
            </div>
        </div>
    </div>

    {# Contact Information Section #}
    <div class="space-y-4">
        <div class="flex items-center gap-2 pb-2 border-b">
            <twig:ux:icon name="lucide:phone" class="h-5 w-5 text-primary"/>
            <h3 class="text-lg font-semibold">Contact Information</h3>
        </div>
        <div class="bg-muted/50 rounded-lg p-4 space-y-4">
            <p class="text-sm text-muted-foreground">
                Contact details for customer inquiries and notifications
            </p>
            {{ form_row(form.contact) }}
        </div>
    </div>

    {# Location Section - Widget handles the entire UI including map #}
    <div class="space-y-4">
        {{ form_row(form.location) }}
    </div>

    {# Store Image Section #}
    <div class="space-y-4">
        <div class="flex items-center gap-2 pb-2 border-b">
            <twig:ux:icon name="lucide:image" class="h-5 w-5 text-primary"/>
            <h3 class="text-lg font-semibold">Store Image</h3>
        </div>
        
        {# Current Image Preview - Horizontal Scroll #}
        {% if initialFormData and initialFormData.image is defined and initialFormData.image|length > 0 %}
            <div class="space-y-2">
                <label class="text-sm font-medium text-muted-foreground">Current Image</label>
                <div class="flex gap-3 overflow-x-auto pb-2">
                    {% for image in initialFormData.image %}
                        <div class="flex-shrink-0 w-24">
                            <div class="border rounded-lg overflow-hidden" style="height: 100px; width: 100px;">
                                <img src="{{ image.url }}" alt="{{ initialFormData.name ?? 'Store' }}" class="w-full h-full object-cover">
                            </div>
                            <p class="text-xs text-muted-foreground mt-1 truncate text-center">{{ image.name }}</p>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}

        {# Upload New Image #}
        <div class="border-2 border-dashed rounded-lg p-8 text-center hover:border-primary transition-colors cursor-pointer relative"
             onclick="document.getElementById('{{ form.image.vars.id }}').click()">
            <twig:ux:icon name="lucide:upload-cloud" class="h-8 w-8 mx-auto mb-2 text-muted-foreground"/>
            <p class="text-base font-medium text-foreground mb-2">Click to upload store image</p>
            <p class="text-sm text-muted-foreground mb-1">or drag and drop</p>
            <p class="text-xs text-muted-foreground mt-4">JPG, PNG or WebP (max. 5MB)</p>
            <p class="text-xs text-muted-foreground mt-1">Recommended: 1200x600px (2:1 ratio)</p>
            <div class="hidden">
                {{ form_widget(form.image) }}
            </div>
        </div>
        {% if form.image.vars.errors|length > 0 %}
            <div class="text-sm text-destructive mt-2">
                {{ form_errors(form.image) }}
            </div>
        {% endif %}
    </div>

    {# Store Owner Login Credentials Section #}
    <div class="space-y-4">
        <div class="flex items-center gap-2 pb-2 border-b">
            <twig:ux:icon name="lucide:key" class="h-5 w-5 text-primary"/>
            <h3 class="text-lg font-semibold">Store Owner Login</h3>
        </div>
        <div class="bg-muted/50 rounded-lg p-4 space-y-4">
            <p class="text-sm text-muted-foreground">
                Login credentials for the store owner to access their dashboard
            </p>
            
            <div>
                {{ form_row(form.ownerEmail) }}
            </div>
            
            <div data-controller="password-repeat">
                {{ form_row(form.ownerPassword) }}
            </div>
            
            <div class="flex items-start gap-2 p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                <twig:ux:icon name="lucide:info" class="h-5 w-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"/>
                <div class="text-sm text-blue-900 dark:text-blue-100">
                    <p class="font-medium mb-1">Password Information</p>
                    <p class="text-blue-700 dark:text-blue-300">If no password is provided, the default password <strong>JoyPharma2025!</strong> will be used</p>
                </div>
            </div>
        </div>
    </div>

    {# Hidden Turbo Frame Buttons #}
    <div class="items-center justify-center gap-2 mt-6 hidden turbo-frame:flex">
        <twig:ui:button:root href="{{ path('admin_store') }}" variant="outline">
            {{ 'Discard'|trans }}
        </twig:ui:button:root>
        <twig:ui:button:root formnovalidate>{{ 'Save Store'|trans }}</twig:ui:button:root>
    </div>

    {{ form_end(form) }}
</div>
