App\Entity\Store:
    operations:
        admin_get_stores:
            class: ApiPlatform\Metadata\GetCollection
            uriTemplate: '/admin/stores'
            security: 'is_granted("ROLE_ADMIN")'
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read']
            openapi:
                summary: 'List all stores (Admin)'

        admin_get_store:
            class: ApiPlatform\Metadata\Get
            uriTemplate: '/admin/stores/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read']
            openapi:
                summary: 'Get store by ID (Admin)'

        admin_create_store:
            class: ApiPlatform\Metadata\Post
            uriTemplate: '/admin/stores'
            security: 'is_granted("ROLE_ADMIN")'
            inputFormats:
                json: ['application/json']
                jsonld: ['application/ld+json']
            denormalizationContext:
                groups: ['store:write', 'contact:write', 'location:write']
            validationContext:
                groups: ['create']
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read']
            openapi:
                summary: 'Create new store (Admin)'
                description: 'Create a new store with optional image. Upload image first using POST /api/media_objects with mapping=store_images, then reference it using IRI (e.g., "/api/media_objects/123"). Use Content-Type: application/ld+json when sending IRIs. The owner user must exist or be created separately via POST /api/admin/users.'

        admin_update_store:
            class: ApiPlatform\Metadata\Put
            uriTemplate: '/admin/stores/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            inputFormats:
                json: ['application/json']
                jsonld: ['application/ld+json']
            denormalizationContext:
                groups: ['store:write', 'contact:write', 'location:write']
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read']
            openapi:
                summary: 'Update store (Admin) - Full update'
                description: 'Update store information including image. Upload image first using POST /api/media_objects with mapping=store_images, then reference it using IRI. Use Content-Type: application/ld+json when sending IRIs. Old image will be automatically deleted if replaced. For partial updates, use PATCH instead.'

        admin_patch_store:
            class: ApiPlatform\Metadata\Patch
            uriTemplate: '/admin/stores/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            inputFormats:
                json: ['application/json']
                jsonld: ['application/ld+json']
            denormalizationContext:
                groups: ['store:write', 'contact:write', 'location:write']
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read']
            openapi:
                summary: 'Update store (Admin) - Partial update'
                description: 'Partially update store information. Only provide the fields you want to update. Use Content-Type: application/ld+json when sending IRIs.'

        admin_delete_store:
            class: ApiPlatform\Metadata\Delete
            uriTemplate: '/admin/stores/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            openapi:
                summary: 'Delete store (Admin)'

        admin_batch_delete_stores:
            class: ApiPlatform\Metadata\Post
            uriTemplate: '/admin/stores/batch-delete'
            security: 'is_granted("ROLE_ADMIN")'
            input: App\Dto\Admin\BatchDeleteInput
            processor: App\State\Admin\BatchDeleteProcessor
            openapi:
                summary: 'Batch delete stores (Admin)'

        get_store:
            class: ApiPlatform\Metadata\Get
            uriTemplate: '/store'
            security: 'is_granted("ROLE_STORE")'
            provider: App\State\Store\StoreProvider
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read', 'media_object:read']
            openapi:
                summary: 'Get current user store profile'
                description: 'Get the store profile for the authenticated store owner'

        update_store_full:
            class: ApiPlatform\Metadata\Put
            uriTemplate: '/store/update'
            security: 'is_granted("ROLE_STORE")'
            provider: App\State\Store\StoreProvider
            inputFormats:
                jsonld: ['application/ld+json']
            denormalizationContext:
                groups: ['store:write', 'contact:write', 'location:write']
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read', 'media_object:read']
            openapi:
                summary: 'Update store profile (Full)'
                description: 'Update the store profile for the authenticated store owner. Use Content-Type: application/ld+json when sending IRIs.'

        update_store_partial:
            class: ApiPlatform\Metadata\Patch
            uriTemplate: '/store/update'
            security: 'is_granted("ROLE_STORE")'
            provider: App\State\Store\StoreProvider
            inputFormats:
                jsonld: ['application/ld+json']
            denormalizationContext:
                groups: ['store:write', 'contact:write', 'location:write']
            normalizationContext:
                groups: ['id:read', 'store:read', 'location:read', 'user:store:read', 'store_setting:read', 'media_object:read']
            openapi:
                summary: 'Update store profile (Partial)'
                description: 'Partially update the store profile for the authenticated store owner. Use Content-Type: application/ld+json when sending IRIs.'

        get_store_statistics:
            class: ApiPlatform\Metadata\Get
            uriTemplate: '/store/statistics'
            security: 'is_granted("ROLE_STORE")'
            provider: App\State\Store\StoreStatisticsProvider
            output: App\Dto\StoreStatistics
            openapi:
                summary: 'Get store dashboard statistics'
                description: 'Get statistics including pending orders, recent orders, earnings, and low stock count for the authenticated store owner'

    normalizationContext:
        groups: ['id:read', 'store:read', 'location:read', 'user:store:read']

