App\Entity\Category:
    operations:
        get_category:
            method: 'GET'
            class: ApiPlatform\Metadata\Get
            uriTemplate: '/category/{id}'
            normalizationContext:
                groups: ['category:read','image:read','media_object:read']
            openapi:
                summary: 'Get a category'
                description: 'Get a category by id'
                parameters:
                    - name: 'id'
                      in: 'path'
                      description:  'The id of the category'


        get_categories:
            method: 'GET'
            class: ApiPlatform\Metadata\GetCollection
            uriTemplate: '/category'
            provider: App\State\Product\CategoryProvider
            normalizationContext:
                groups: ['id:read','category:read','image:read','media_object:read']
            openapi:
                summary: 'Get all categories'
                description: 'Get all categories. Filter by parent category using parent parameter (use parent=null for root categories or parent={id} for child categories).'
                parameters:
                    - name: 'parent'
                      in: 'query'
                      required: false
                      description: 'Filter by parent category ID. Use null to get root categories (categories without parent).'
                      schema:
                        oneOf:
                          - type: 'integer'
                            description: 'Parent category ID'
                          - type: 'string'
                            enum: ['null']
                            description: 'Use "null" to get root categories'
                    - name: 'page'
                      in: 'query'
                      required: false
                      schema:
                        type: 'integer'
                        default: 1

        # Admin specific endpoints
        admin_get_categories:
            class: ApiPlatform\Metadata\GetCollection
            uriTemplate: '/admin/categories'
            security: 'is_granted("ROLE_ADMIN")'
            normalizationContext:
                groups: ['id:read', 'category:read', 'image:read', 'media_object:read']
            openapi:
                summary: 'List all categories (Admin)'
                description: 'Get list of all categories with hierarchical structure'

        admin_get_category:
            class: ApiPlatform\Metadata\Get
            uriTemplate: '/admin/categories/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            normalizationContext:
                groups: ['id:read', 'category:read', 'image:read', 'media_object:read']
            openapi:
                summary: 'Get category by ID (Admin)'
                description: 'Get detailed information about a specific category'

        admin_create_category:
            class: ApiPlatform\Metadata\Post
            uriTemplate: '/admin/categories'
            security: 'is_granted("ROLE_ADMIN")'
            input: App\Dto\Admin\CategoryInput
            inputFormats:
                multipart: ['multipart/form-data']
            processor: App\State\Admin\CategoryProcessor
            normalizationContext:
                groups: ['id:read', 'category:read', 'image:read', 'media_object:read']
            openapi:
                summary: 'Create new category (Admin)'
                description: 'Create a new category with optional parent category, image and icon. If category with same name and parent exists, it will be returned/updated instead of creating a duplicate.'
                requestBody:
                    content:
                        multipart/form-data:
                            schema:
                                type: object
                                required:
                                    - name
                                properties:
                                    name:
                                        type: string
                                        description: 'Category name (required)'
                                    description:
                                        type: string
                                        description: 'Category description'
                                    parent:
                                        type: integer
                                        nullable: true
                                        description: 'Parent category ID (null for root categories)'
                                    color:
                                        type: string
                                        description: 'Category color (hex code)'
                                    image:
                                        type: string
                                        format: binary
                                        description: 'Category image file (JPEG, PNG, GIF, WebP)'
                                    icon:
                                        type: string
                                        format: binary
                                        description: 'Category icon/SVG file'

        admin_update_category:
            class: ApiPlatform\Metadata\Put
            uriTemplate: '/admin/categories/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            input: App\Dto\Admin\CategoryInput
            inputFormats:
                multipart: ['multipart/form-data']
            processor: App\State\Admin\CategoryProcessor
            normalizationContext:
                groups: ['id:read', 'category:read', 'image:read', 'media_object:read']
            openapi:
                summary: 'Update category (Admin)'
                description: 'Update category information including parent relationship, image and icon'
                requestBody:
                    content:
                        multipart/form-data:
                            schema:
                                type: object
                                required:
                                    - name
                                properties:
                                    name:
                                        type: string
                                        description: 'Category name (required)'
                                    description:
                                        type: string
                                        description: 'Category description'
                                    parent:
                                        type: integer
                                        nullable: true
                                        description: 'Parent category ID (null for root categories)'
                                    color:
                                        type: string
                                        description: 'Category color (hex code)'
                                    image:
                                        type: string
                                        format: binary
                                        description: 'Category image file (JPEG, PNG, GIF, WebP)'
                                    icon:
                                        type: string
                                        format: binary
                                        description: 'Category icon/SVG file'

        admin_delete_category:
            class: ApiPlatform\Metadata\Delete
            uriTemplate: '/admin/categories/{id}'
            security: 'is_granted("ROLE_ADMIN")'
            openapi:
                summary: 'Delete category (Admin)'
                description: 'Permanently delete a category'

        admin_batch_delete_categories:
            class: ApiPlatform\Metadata\Post
            uriTemplate: '/admin/categories/batch-delete'
            security: 'is_granted("ROLE_ADMIN")'
            input: App\Dto\Admin\BatchDeleteInput
            processor: App\State\Admin\BatchDeleteProcessor
            openapi:
                summary: 'Batch delete categories (Admin)'
                description: 'Delete multiple categories at once'
                

    normalizationContext:
        groups: ['id:read','category:read','image:read','media_object:read']
                      
