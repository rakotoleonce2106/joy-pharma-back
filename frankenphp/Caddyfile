{
	# Enable FrankenPHP with worker mode
	frankenphp {
		worker {
			file public/index.php
			num {$FRANKENPHP_NUM_WORKERS:2}
			env APP_RUNTIME Runtime\FrankenPhpSymfony\Runtime
		}
	}

	# Global options
	order frankenphp before file_server
	order php_server before file_server
}

# HTTP server
{$SERVER_NAME:localhost} {
	log {
		# Redact the authorization query parameter that can be set by Mercure
		format filter {
			wrap console
			fields {
				uri query {
					replace authorization REDACTED
				}
			}
		}
	}

	root * public/
	encode zstd br gzip

	# Disable Topics tracking if not enabled explicitly: https://github.com/jkarlin/topics
	header ?Permissions-Policy "browsing-topics=()"

	# Enable the worker mode
	frankenphp

	# Fallback to index.php for Symfony
	php_server
}

